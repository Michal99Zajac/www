---
import { Image } from 'astro:assets'

import badge1 from '@/assets/aws-certified-solutions-architect-associate.png'
import badge2 from '@/assets/aws-cloud-quest-solutions-architect.png'
import badge3 from '@/assets/aws-partner-technical-accredited.png'
import cloudOneImage from '@/assets/cloud-1.png'
import dscoutLogoTile from '@/assets/dscout-logo-tile.png'
import rainbowCircleImage from '@/assets/rainbow-circle.svg'
import badge4 from '@/assets/well-architected-proficient.png'
import badge5 from '@/assets/well-architected-proficient.png'
import Project from '@/components/project.astro'
import Layout from '@/layouts/Layout.astro'

function shuffle<T>(array: T[]): T[] {
  return array
    .map((value) => ({ value, sort: Math.random() }))
    .sort((a, b) => a.sort - b.sort)
    .map(({ value }) => value)
}

const items = [
  'TypeScript',
  'React',
  'Tailwind',
  'Angular',
  'Python',
  'Vue',
  'Svelte',
  'Solid',
  'SvelteKit',
  'Next.js',
  'Svelte',
  'Solid',
  'SvelteKit',
  'Django',
  'Express',
  'Fastify',
  'Jira',
  'Slack',
  'Postgres',
  'MySql',
  'MongoDB',
  'AWS',
  'Azure',
  'Firebase',
]

const row1 = shuffle([...items]).slice(0, 20)
const row2 = shuffle([...items]).slice(0, 20)
const row3 = shuffle([...items]).slice(0, 20)
---

<Layout>
  <header class="mb-32">
    <nav class="container mx-auto flex items-center justify-center gap-x-4 px-6 py-4">
      <a class="text-base" href="#hero">Hero</a>
      <a class="text-base" href="#hero">Hero</a>
      <a class="text-base" href="#hero">Hero</a>
      <a class="text-base" href="#hero">Hero</a>
    </nav>
  </header>
  <main>
    <section class="container mx-auto px-6">
      <p class="mb-4 text-center text-lg">Hi! Iâ€™m Michal</p>
      <h1 class="font-libre mb-12 text-center text-6xl">
        <span id="hero-profession">Frontend Engineer</span><br />I'm always here for you
      </h1>
      <div class="relative mb-32">
        <div class="aspect-2/1 overflow-hidden">
          <img
            src={rainbowCircleImage.src}
            alt="RainbowCircle"
            class="animate-duration-[30000ms] w-full animate-spin"
          />
        </div>
        <img
          src={cloudOneImage.src}
          alt="CloudOne"
          class="animate-shake animate-infinite animate-duration-[10000ms] animate-ease-linear absolute -bottom-[80px] left-[45%] w-3/5 -translate-x-1/2"
        />
        <img
          src={cloudOneImage.src}
          alt="CloudOne"
          class="animate-shake animate-infinite animate-delay-1000 animate-duration-[20000ms] animate-ease-linear absolute -bottom-[100px] -left-[120px] w-1/2"
        />
        <img
          src={cloudOneImage.src}
          alt="CloudOne"
          class="animate-shake animate-infinite animate-delay-2000 animate-duration-[20000ms] animate-ease-linear absolute -right-[100px] -bottom-[80px] w-1/2"
        />
      </div>
      <p class="mx-auto w-1/2 text-center text-lg">
        Simplicity is my superpower. I turn complex ideas into experiences users love and investors
        trust. I help SaaS, AI, and Dev founders craft story-driven brands and products.
      </p>
      <hr class="mx-auto my-12 h-2 w-2/5 border-dashed" />
    </section>
    <section class="py-16">
      <h2 class="font-libre mb-8 text-center text-3xl">A wide range of possibilities!</h2>
      <div class="overflow-x-hidden whitespace-nowrap">
        <div
          class="animate-marquee-left animate-duration-[140s] mb-4 flex w-max items-center gap-x-4"
        >
          {
            row1.map((item) => (
              <div class="font-libre flex w-max min-w-[200px] items-center justify-center gap-x-4 rounded-lg border-1 border-dashed border-gray-300 px-4 py-8">
                <span>{item}</span>
              </div>
            ))
          }
          {
            row1.map((item) => (
              <div class="font-libre flex w-max min-w-[240px] items-center justify-center gap-x-4 rounded-lg border-1 border-dashed border-gray-300 p-4 py-8">
                <span>{item}</span>
              </div>
            ))
          }
        </div>
        <div
          class="animate-marquee-right animate-duration-[120s] mb-4 flex w-max items-center gap-x-4"
        >
          {
            row2.map((item) => (
              <div class="font-libre flex w-max min-w-[200px] items-center justify-center gap-x-4 rounded-lg border-1 border-dashed border-gray-300 px-4 py-8">
                <span>{item}</span>
              </div>
            ))
          }
          {
            row2.map((item) => (
              <div class="font-libre flex w-max min-w-[240px] items-center justify-center gap-x-4 rounded-lg border-1 border-dashed border-gray-300 p-4 py-8">
                <span>{item}</span>
              </div>
            ))
          }
        </div>
        <div class="animate-marquee-left animate-duration-[100s] flex w-max items-center gap-x-4">
          {
            row3.map((item) => (
              <div class="font-libre flex w-max min-w-[200px] items-center justify-center gap-x-4 rounded-lg border-1 border-dashed border-gray-300 px-4 py-8">
                <span>{item}</span>
              </div>
            ))
          }
          {
            row3.map((item) => (
              <div class="font-libre flex w-max min-w-[240px] items-center justify-center gap-x-4 rounded-lg border-1 border-dashed border-gray-300 p-4 py-8">
                <span>{item}</span>
              </div>
            ))
          }
        </div>
      </div>
    </section>
    <section class="container mx-auto px-32 py-16">
      <h2 class="font-libre mb-4 text-center text-4xl">Tried and tested, ready for more!</h2>
      <p class="mb-12 text-center">
        I love learning more after work, and I'm always eager to deliver the best I can!
      </p>
      <div class="medals-wrapper flex items-center gap-4">
        <Image src={badge5} alt="badge5" class="medal translate-x-80 scale-80" />
        <Image src={badge2} alt="badge2" class="medal z-1 translate-x-40 scale-90" />
        <Image src={badge1} alt="badge1" class="medal z-2" />
        <Image src={badge3} alt="badge3" class="medal z-1 -translate-x-40 scale-90" />
        <Image src={badge4} alt="badge4" class="medal -translate-x-80 scale-80" />
      </div>
    </section>
    <section class="container mx-auto px-64 py-32">
      <h2 class="font-libre mb-4 text-4xl">Not just theory!</h2>
      <p class="mb-8">Projects into which I have poured my heart and soul!</p>
      <div class="grid grid-cols-2 gap-6">
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="blue"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="red"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="green"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="green"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
      </div>
      <div
        class="font-libre col-span-4 my-8 h-max rounded-full border-1 border-dashed border-gray-300 p-4 text-center text-xl transition-all hover:bg-black hover:text-white"
      >
        Always on the move to get things done. Introducing side projects!
      </div>
      <div class="grid grid-cols-2 gap-6">
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="pink"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="yellow"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="pruple"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
        <Project
          src={dscoutLogoTile}
          alt="CLoudf"
          color="pruple"
          company="Dscout Private Panels"
          description="Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book."
        />
      </div>
    </section>
  </main>
  <footer class="bulge-grid grid grid-cols-32 gap-2">
    {
      Array.from({ length: 32 * 7 }).map((_, index) => (
        <div class="grid-tile aspect-square rounded-sm bg-pink-200" data-index={index} />
      ))
    }
  </footer>
</Layout>

<style>
  .medal {
    transition: all 0.5s ease-in-out;
  }

  .medals-wrapper:hover > .medal {
    translate: 0;
    scale: 100%;
  }

  .bulge-grid {
    --cols: 32;

    position: relative;
  }

  .grid-tile {
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform-origin: center;
    position: relative;
    z-index: 1;
  }

  .grid-tile.bulge-center {
    transform: scale(1.4) translateZ(0);
    z-index: 20;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgb(0 0 0 / 15%);
  }

  .grid-tile.bulge-ring-1 {
    transform: scale(1.25) translateZ(0);
    z-index: 15;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgb(0 0 0 / 10%);
  }

  .grid-tile.bulge-ring-2 {
    transform: scale(1.15) translateZ(0);
    z-index: 10;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgb(0 0 0 / 8%);
  }

  .grid-tile.bulge-ring-3 {
    transform: scale(1.08) translateZ(0);
    z-index: 5;
    border-radius: 4px;
    box-shadow: 0 1px 4px rgb(0 0 0 / 5%);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const gridTiles = document.querySelectorAll('.grid-tile')
    const cols = 32
    let activeIndex = -1

    const clearBulge = () => {
      gridTiles.forEach((tile) => {
        tile.classList.remove('bulge-center', 'bulge-ring-1', 'bulge-ring-2', 'bulge-ring-3')
      })
    }

    const calculateDistance = (index1, index2) => {
      const row1 = Math.floor(index1 / cols)
      const col1 = index1 % cols
      const row2 = Math.floor(index2 / cols)
      const col2 = index2 % cols

      return Math.max(Math.abs(row1 - row2), Math.abs(col1 - col2))
    }

    const createBulge = (centerIndex) => {
      clearBulge()

      gridTiles.forEach((tile, index) => {
        const distance = calculateDistance(centerIndex, index)

        if (distance === 0) {
          tile.classList.add('bulge-center')
        } else if (distance === 1) {
          tile.classList.add('bulge-ring-1')
        } else if (distance === 2) {
          tile.classList.add('bulge-ring-2')
        } else if (distance === 3) {
          tile.classList.add('bulge-ring-3')
        }
      })
    }

    gridTiles.forEach((tile, index) => {
      tile.addEventListener('mouseenter', () => {
        activeIndex = index
        createBulge(index)
      })

      tile.addEventListener('mouseleave', () => {
        setTimeout(() => {
          if (activeIndex === index) {
            clearBulge()
            activeIndex = -1
          }
        }, 100)
      })
    })

    const bulgeGrid = document.querySelector('.bulge-grid')
    let rafId

    bulgeGrid.addEventListener('mousemove', (e) => {
      if (rafId) cancelAnimationFrame(rafId)

      rafId = requestAnimationFrame(() => {
        const rect = bulgeGrid.getBoundingClientRect()
        const x = e.clientX - rect.left
        const y = e.clientY - rect.top

        const tileWidth = rect.width / cols
        const tileHeight = tileWidth // aspect-square

        const col = Math.floor(x / tileWidth)
        const row = Math.floor(y / tileHeight)
        const hoveredIndex = row * cols + col

        if (hoveredIndex >= 0 && hoveredIndex < gridTiles.length && hoveredIndex !== activeIndex) {
          activeIndex = hoveredIndex
          createBulge(hoveredIndex)
        }
      })
    })

    bulgeGrid.addEventListener('mouseleave', () => {
      if (rafId) cancelAnimationFrame(rafId)
      clearBulge()
      activeIndex = -1
    })
  })
</script>
